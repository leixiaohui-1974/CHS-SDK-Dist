# 示例 5：分层控制

本示例演示了一个简单的两级分层控制架构。一个中央智能体向一个本地智能体发布高级指令，然后由该本地智能体负责执行底层的控制操作。

## 场景

该场景直接建立在示例 4 的基础之上。我们使用相同的水库-闸门系统，并配备一个本地闸门控制智能体。

层级结构如下：
1.  **本地层**：`LocalGateControlAgent` 负责根据其当前的水位设定点（初始为 51.0 米）来开启或关闭闸门。
2.  **监督层**：引入一个新的 `CentralCommandAgent`。在模拟进行 200 秒后，该智能体发布一个命令，将系统的目标设定点更改为一个更保守的值 50.5 米。

本地智能体接收到这个新的设定点后，会相应地调整其行为，而中央智能体则无需了解闸门操作的底层细节。这展示了分层控制系统中的“关注点分离”原则。

## 组件与智能体

*   **主水库和防洪闸**：物理组件。
*   **入流智能体**：为水库提供恒定的入流。
*   **水库孪生智能体**：发布水库的状态。
*   **本地闸门控制智能体**：订阅水库状态和一个新的指令主题。它通过控制闸门来维持当前的设定点。
*   **中央指令智能体**：一个自定义智能体，在 200 秒后向指令主题发布一个新的设定点。

## 如何运行

要运行此模拟，请执行此目录中的 `run.py` 脚本：

```bash
python run.py
```
您将观察到闸门控制器维持初始的 51.0 米设定点。200 秒后，中央智能体将发布一个新指令，本地控制器将开始工作以达到新的 50.5 米设定点。
